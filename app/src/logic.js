import {inject} from 'aurelia-framework'
import {Configure} from 'aurelia-configuration'

import Web3 from 'web3'
import Wallet from 'ethereumjs-wallet'

@inject(Configure)
export class Logic {
    constructor(config) {
        this.config = config
        // TODO: test browser compatibility (especially crypto api)

        // TODO: how to get this working?
        // this.contract = config.get('ethereum.contract.address')
        //this.contract.address = "0xefb28f664b5d87c4efe0700d59a1793f2c0f4c0e" // hardcoding in the meantime
        //this.contract = Contracts.bkcvote

        // this is a workaround to get() currently supporting only 2 levels, see https://github.com/Vheissu/aurelia-configuration/issues/68
        var rpcAddr = config.getAll().ethereum.rpc
        var web3 = new Web3(new Web3.providers.HttpProvider(rpcAddr))
        console.log(web3)

        console.log('coinbase: ' + web3.eth.coinbase)
        var Contract = web3.eth.contract(this.contracts.BKCVote.info.abiDefinition)
        this.contractInstance = Contract.at(this.config.getAll().ethereum.contract.address)
        console.log('instance addr: ' + this.contractInstance.address)

        console.log('votersCount(): ' + this.contractInstance.getVotersCount())

    }

    getRandomToken() {
        var array = new Uint32Array(8)
        window.crypto.getRandomValues(array)
        var token = array.join('')
        return token
        // TODO: convert to an alphanumberic string
    }

    createNewAddress() {
        //var wallet = new Wallet()
        var newAddr = Wallet.generate()
        return newAddr.getAddressString()
    }

    // requests some funding for the given address, needed in order to be able to send transactions
    // It may take a while (~20 seconds) for the funds to become available. That delay needs to be handled in UI
    // TODO: persist txhash somewhere, e.g. in appstate?
    refuelTxHash = null
    fundAccount(address) {
        $.ajax( this.config.getAll().refuelBaseUrl + address )
            .done( (data, textStatus, jqXHR) => {
                console.log('refuel done: ' + data)
                this.refuelTxHash = data.txHash
                console.log(this.refuelTxHash)
            })
            .fail( ( jqXHR, textStatus, errorThrown) => {
                console.log('refuel fail: ' + textStatus + ' - ' + errorThrown)
            })
    }


    contracts = {
        "BKCVote": {
            "code": "0x60606040526040516122623803806122628339810160405280516080805160a05160028054600160a860020a0319166101006c01000000000000000000000000338102048102919091178255600084815560018481559787018051600380549381905291999698959791967fc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85b6020918516159095026000190190931694909404601f9081019290920483019401908390106100dd57805160ff19168380011785555b5061010d9291505b8082111561014657600081556001016100c9565b828001600101855582156100c1579182015b828111156100c15782518260005055916020019190600101906100ef565b5050600780546001810180835590919082801582901161014a5760070281600702836000526020600020918201910161014a919061019e565b5090565b5050600980546001810180835590935090915082801582901161031f5760050281600502836000526020600020918201910161031f919061034b565b5050600681018054600160b060020a03191690556007015b80821115610146578054600160a060020a031916815560018082018054600080835592600260001991831615610100029190910190911604601f81901061028957505b5060028201600050805460018160011615610100020316600290046000825580601f106102a757505b5060038201600050805460018160011615610100020316600290046000825580601f106102c557505b5060048201600050805460018160011615610100020316600290046000825580601f106102e357505b5060058201600050805460018160011615610100020316600290046000825580601f106103015750610186565b601f0160209004906000526020600020908101906101e191906100c9565b601f01602090049060005260206000209081019061020a91906100c9565b601f01602090049060005260206000209081019061023391906100c9565b601f01602090049060005260206000209081019061025c91906100c9565b601f01602090049060005260206000209081019061018691906100c9565b5050600060048190556005555050505050611e248061043e6000396000f35b5050600060048201556005015b80821115610146578054600160a060020a031916815560018082018054600080835592600260001991831615610100029190910190911604601f8190106103e457505b5060028201600050805460018160011615610100020316600290046000825580601f1061040257505b5060038201600050805460018160011615610100020316600290046000825580601f10610420575061033e565b601f01602090049060005260206000209081019061038e91906100c9565b601f0160209004906000526020600020908101906103b791906100c9565b601f01602090049060005260206000209081019061033e91906100c956606060405236156100e55760e060020a600035046305280e5281146100ea57806312fa6feb146101425780631625aeef1461015357806363a9c3d7146101705780636dd7d8ea146101b35780636f52d1e91461020257806377c060d4146102b95780637938355a146103095780637b2feaaa1461032657806385e8e7a71461033457806386bb568c146103995780638da5cb5b146103a85780638df6c5a0146103c55780638f6e92cc14610560578063a2d702f11461056e578063a6efc3651461060b578063b903edcd14610619578063c0f2a77714610627578063da58c7d914610637575b610002565b34610002576106a66004356024356002546000906101009004600160a060020a03908116339190911614610bc15760408051600081529051600080516020611e048339815191529181900360200190a1506000610d03565b34610002576106a660025460ff1681565b34610002576106ba60043560066020526000908152604090205481565b34610002576106a6600435600080548190431015610d095760408051600181529051600080516020611e048339815191529181900360200190a160009150610f17565b34610002576106a66004356000805481904310806101d2575060015443115b15610f1d5760408051600181529051600080516020611e048339815191529181900360200190a160009150610f17565b34610002576106cc600160a060020a0333166000908152600660205260408120548190818111801561025d57506007805482908110156100025790600052602060002090600702016000506006015460ff60a860020a909104165b1561112657600160a060020a033381166000908152600a60205260409020546007805491909216919083908110156100025790600052602060002090600702016000506006015490935060ff60a060020a90910416915061112e565b34610002576106ef60043560098054829081101561000257906000526020600020906005020160005080546004820154600160a060020a0390911692506001820191600281019160039091019085565b34610002576106ba60043560086020526000908152604090205481565b34610002576106ba60005481565b346100025761088560038054604080516020601f6002600019610100600188161502019095169490940493840181900481028201810190925282815292919083018282801561115e5780601f106111335761010080835404028352916020019161115e565b34610002576106ba6009545b90565b34610002576108f3600254600160a060020a036101009091041681565b346100025760408051602060046024803582810135601f81018590048502860185019096528585526106a69583359593946044949392909201918190840183828082843750506040805160209735808a0135601f81018a90048a0283018a019093528282529698976064979196506024919091019450909250829150840183828082843750506040805160209735808a0135601f81018a90048a0283018a019093528282529698976084979196506024919091019450909250829150840183828082843750506040805160209735808a0135601f81018a90048a0283018a0190935282825296989760a4979196506024919091019450909250829150840183828082843750506040805160209735808a0135601f81018a90048a0283018a0190935282825296989760c497919650602491909101945090925082915084018382808284375094965050505050505060025460009081906101009004600160a060020a039081163391909116146111665760408051600081529051600080516020611e048339815191529181900360200190a16000915061130e565b34610002576106ba60045481565b346100025760408051602060046024803582810135601f81018590048502860185019096528585526106a69583359593946044949392909201918190840183828082843750949650505050505050600254600090819081906101009004600160a060020a039081163391909116146118375760408051600081529051600080516020611e048339815191529181900360200190a160009250611972565b34610002576106ba60015481565b34610002576106ba60055481565b34610002576106ba6007546103a5565b346100025761090f60043560078054829081101561000257906000526020600020906007020160005080546006820154600160a060020a03918216935060018301926002810192600382019260048301926005019181169060ff60a060020a820481169160a860020a90041689565b604080519115158252519081900360200190f35b60408051918252519081900360200190f35b60408051600160a060020a03909316835290151560208301528051918290030190f35b60408051600160a060020a03871681526080810183905260a0602082018181528754600260001961010060018416150201909116049183018290529192830190606084019060c0850190899080156107885780601f1061075d57610100808354040283529160200191610788565b820191906000526020600020905b81548152906001019060200180831161076b57829003601f168201915b50508481038352875460026000196101006001841615020190911604808252602090910190889080156107fc5780601f106107d1576101008083540402835291602001916107fc565b820191906000526020600020905b8154815290600101906020018083116107df57829003601f168201915b50508481038252865460026000196101006001841615020190911604808252602090910190879080156108705780601f1061084557610100808354040283529160200191610870565b820191906000526020600020905b81548152906001019060200180831161085357829003601f168201915b50509850505050505050505060405180910390f35b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156108e55780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b60408051600160a060020a039092168252519081900360200190f35b604051808a600160a060020a03168152602001806020018060200180602001806020018060200189600160a060020a031681526020018815158152602001871515815260200186810386528e8181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156109d65780601f106109ab576101008083540402835291602001916109d6565b820191906000526020600020905b8154815290600101906020018083116109b957829003601f168201915b505086810385528d54600260001961010060018416150201909116048082526020909101908e908015610a4a5780601f10610a1f57610100808354040283529160200191610a4a565b820191906000526020600020905b815481529060010190602001808311610a2d57829003601f168201915b505086810384528c54600260001961010060018416150201909116048082526020909101908d908015610abe5780601f10610a9357610100808354040283529160200191610abe565b820191906000526020600020905b815481529060010190602001808311610aa157829003601f168201915b505086810383528b54600260001961010060018416150201909116048082526020909101908c908015610b325780601f10610b0757610100808354040283529160200191610b32565b820191906000526020600020905b815481529060010190602001808311610b1557829003601f168201915b505086810382528a54600260001961010060018416150201909116048082526020909101908b908015610ba65780601f10610b7b57610100808354040283529160200191610ba6565b820191906000526020600020905b815481529060010190602001808311610b8957829003601f168201915b50509e50505050505050505050505050505060405180910390f35b600054431115610bf55760408051600181529051600080516020611e048339815191529181900360200190a1506000610d03565b600160a060020a0383166000908152600660205260409020541580610c305750600160a060020a038216600090815260066020526040902054155b15610c5f5760408051600281529051600080516020611e048339815191529181900360200190a1506000610d03565b600160a060020a038316600090815260066020526040902054600780548492908110156100025790600052602060002090600702016000506006018054606060020a92830292909204600160a060020a031990921691909117905560408051600160a060020a0385811682528416602082015281517f467705348409ca52cc480a02712a5ddbc8436ff8a6de0cf1f9dddb249ad0efca929181900390910190a15060015b92915050565b50600160a060020a038216600090815260066020526040902054801515610d555760408051600281529051600080516020611e048339815191529181900360200190a160009150610f17565b6007805482908110156100025790600052602060002090600702016000506006015460ff60a860020a909104161515610db35760408051600681529051600080516020611e048339815191529181900360200190a160009150610f17565b33600160a060020a0316600760005082815481101561000257906000526020600020906007020160005060060154600160a060020a031614610e1a5760408051600081529051600080516020611e048339815191529181900360200190a160009150610f17565b600160a060020a038084166000908152600a602090815260408083205490931682526008905220546009805490919081101561000257906000526020600020906005020160005060040180546001908101909155600780548390811015610002579060005260206000209060070201600050600601805460f860020a9283029290920460a060020a0274ff0000000000000000000000000000000000000000199092169190911790556005805460001901905560408051600160a060020a0380861682523316602082015281517f30a2849cfaaf405f9497a707bb8e2698eb27d733d6593a27e1448029cb869a5e929181900390910190a1600191505b50919050565b50600160a060020a033316600090815260066020526040902054801580610f5a5750600160a060020a038316600090815260086020526040902054155b15610f8a5760408051600281529051600080516020611e048339815191529181900360200190a160009150610f17565b6007805482908110156100025790600052602060002090600702016000506006015460ff60a860020a9091041615610fe75760408051600481529051600080516020611e048339815191529181900360200190a160009150610f17565b6007805460009190839081101561000257906000526020600020906007020160005060060154600160a060020a031614156110475760408051600781529051600080516020611e048339815191529181900360200190a160009150610f17565b60016007600050828154811015610002579060005260206000209060070201600050600601805460f860020a9283029290920460a860020a0275ff00000000000000000000000000000000000000000019909216919091179055600160a060020a0333166000818152600a60209081526040918290208054606060020a80890204600160a060020a0319909116179055600480546001908101909155600580549091019055815192835290517f9a9a844017ad8466816a800b481d993909e70e1ec14b6c0b26b4b06e6fec98639281900390910190a160019150610f17565b600092508291505b509091565b820191906000526020600020905b81548152906001019060200180831161114157829003601f168201915b505050505081565b60005443111561119b5760408051600181529051600080516020611e048339815191529181900360200190a16000915061130e565b600160a060020a03881660009081526006602052604081205411156111e55760408051600281529051600080516020611e048339815191529181900360200190a16000915061130e565b6007805460018101808355909190828015829011611319576007028160070283600052602060002091820191016113199190611436565b505060c08201516006918201805460e085015161010090950151600160a060020a0319918216606060020a948502949094049390931774ff0000000000000000000000000000000000000000191660a060020a60f860020a968702879004021775ff000000000000000000000000000000000000000000191660a860020a938602959095049290920293909317909255600160a060020a038a16600081815260209283526040808220869055600a8452908190208054909416909355825190815291517ff91e406c7179dd602438066c1f63cb1221d2b1904b9d0d2dc96b936aea7e336a9281900390910190a1600191505b509695505050505050565b50505090506101206040519081016040528089815260200188815260200187815260200186815260200185815260200184815260200160008152602001600081526020016000815260200150600760005082815481101561000257906000526020600020906007020160005060008201518160000160006101000a815481600160a060020a030219169083606060020a9081020402179055506020820151816001016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106115cb57805160ff19168380011785555b506115fb92915061153b565b505060068101805475ffffffffffffffffffffffffffffffffffffffffffff191690556007015b8082111561154f578054600160a060020a031916815560018082018054600080835592600260001991831615610100029190910190911604601f81901061152157505b5060028201600050805460018160011615610100020316600290046000825580601f1061155357505b5060038201600050805460018160011615610100020316600290046000825580601f1061157157505b5060048201600050805460018160011615610100020316600290046000825580601f1061158f57505b5060058201600050805460018160011615610100020316600290046000825580601f106115ad575061140f565b601f01602090049060005260206000209081019061147991905b8082111561154f576000815560010161153b565b5090565b601f0160209004906000526020600020908101906114a2919061153b565b601f0160209004906000526020600020908101906114cb919061153b565b601f0160209004906000526020600020908101906114f4919061153b565b601f01602090049060005260206000209081019061140f919061153b565b82800160010185558215611403579182015b828111156114035782518260005055916020019190600101906115dd565b50506040820151816002016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061165a57805160ff19168380011785555b5061168a92915061153b565b8280016001018555821561164e579182015b8281111561164e57825182600050559160200191906001019061166c565b50506060820151816003016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106116e957805160ff19168380011785555b5061171992915061153b565b828001600101855582156116dd579182015b828111156116dd5782518260005055916020019190600101906116fb565b50506080820151816004016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061177857805160ff19168380011785555b506117a892915061153b565b8280016001018555821561176c579182015b8281111561176c57825182600050559160200191906001019061178a565b505060a0820151816005016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061180757805160ff19168380011785555b5061121c92915061153b565b828001600101855582156117fb579182015b828111156117fb578251826000505591602001919060010190611819565b60005443111561186c5760408051600181529051600080516020611e048339815191529181900360200190a160009250611972565b600160a060020a03851660009081526008602052604081205411806118a75750600160a060020a038516600090815260066020526040902054155b156118d75760408051600281529051600080516020611e048339815191529181900360200190a160009250611972565b600980546001810180835590919082801582901161197a5760050281600502836000526020600020918201910161197a9190611a47565b505060809190910151600490910155600160a060020a038516600081815260086020908152604091829020859055815192835290517f5da3a3162b3da501a12a7898b1c84122526c76201f96aa445c7e0a4b0b6d964c9281900390910190a1600192505b505092915050565b505050600160a060020a0386166000908152600660205260409020546007805492945091811015610002579060005260206000209060070201600050905060a060405190810160405280868152602001826001016000508054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611b655780601f10611b3a57610100808354040283529160200191611b65565b5050600060048201556005015b8082111561154f578054600160a060020a031916815560018082018054600080835592600260001991831615610100029190910190911604601f819010611ae057505b5060028201600050805460018160011615610100020316600290046000825580601f10611afe57505b5060038201600050805460018160011615610100020316600290046000825580601f10611b1c5750611a3a565b601f016020900490600052602060002090810190611a8a919061153b565b601f016020900490600052602060002090810190611ab3919061153b565b601f016020900490600052602060002090810190611a3a919061153b565b820191906000526020600020905b815481529060010190602001808311611b4857829003601f168201915b5050509183525050600283810180546040805160206001841615610100026000190190931694909404601f81018390048302850183019091528084529381019390830182828015611bf75780601f10611bcc57610100808354040283529160200191611bf7565b820191906000526020600020905b815481529060010190602001808311611bda57829003601f168201915b505050918352505060208101869052600060409091015260098054849081101561000257906000526020600020906005020160005060008201518160000160006101000a815481600160a060020a030219169083606060020a9081020402179055506020820151816001016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10611cb657805160ff19168380011785555b50611ce692915061153b565b82800160010185558215611caa579182015b82811115611caa578251826000505591602001919060010190611cc8565b50506040820151816002016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10611d4557805160ff19168380011785555b50611d7592915061153b565b82800160010185558215611d39579182015b82811115611d39578251826000505591602001919060010190611d57565b50506060820151816003016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10611dd457805160ff19168380011785555b5061190e92915061153b565b82800160010185558215611dc8579182015b82811115611dc8578251826000505591602001919060010190611de656b48fb6cf86d9c47e2268650bac422c18104332e413943278776f488788b991da",
            "info": {
                "source": "\ncontract BKCVote {\n\n   uint public blockStart;\n   uint public blockEnd;\n   bool public ended;\n   address public owner;\n   string public electionName;\n   uint public votesDone;\n   uint public votesToVerify;\n\n   event newVoter(address);\n   event newPostulant(address);\n   event voteAdded(address);\n   event voteVerified(address, address);\n   event verifierSet(address, address);\n   event error(uint);\n\n   struct Voter {\n       address addr;\n       string name;\n       string surename;\n       string born_date;\n       string personal_id;\n       string phisical_address;\n       address verifier;\n       bool verified;\n       bool alreadyVote;\n   }\n\n   struct Postulant {\n       address addr;\n       string name;\n       string surename;\n       string party;\n       uint votesAmount;\n   }\n\n   mapping(address => uint) public votersIndex;\n   Voter[] public voters;\n\n   mapping(address => uint) public postulantsIndex;\n   Postulant[] public postulants;\n\n   mapping(address => address) private votes;\n\n   function BKCVote(string _electionName, uint _blockStart, uint _blockEnd) {\n       ended = false;\n       owner = msg.sender;\n       blockStart = _blockStart;\n       blockEnd = _blockEnd;\n       electionName = _electionName;\n       voters.length ++;\n       postulants.length ++;\n       votesDone = 0;\n       votesToVerify = 0;\n   }\n\n   /*\n\n   ERROR CODES\n\n   Error 0 = Unauthorized Access.\n   Error 1 = Invalid Block Access.\n   Error 2 = Invalid Address.\n   Error 3 = Insufficent Balance.\n   Error 4 = Vote aldready done.\n   Error 5 = Vote already verified.\n   Error 6 = Vote not done.\n   Error 7 = Verifier not set.\n\n   */\n\n   function addVoter(address _addr,  string _name,  string _surename,  string _born_date,  string _personal_id, string _phisical_address) returns (bool){\n       if (owner != msg.sender){\n           error(0);\n           return (false);\n       } else if (block.number > blockStart){\n           error(1);\n           return (false);\n       } else if (votersIndex[_addr] > 0) {\n           error(2);\n           return (false);\n       } else {\n           uint pos = voters.length ++;\n           voters[pos] = Voter(_addr, _name, _surename, _born_date, _personal_id, _phisical_address, 0x0, false, false);\n           votersIndex[_addr] = pos;\n           votes[_addr] = address(0x0);\n           newVoter(_addr);\n           return (true);\n       }\n   }\n\n   function addPostulant(address _addr,  string _party) returns (bool){\n       if (owner != msg.sender){\n           error(0);\n           return (false);\n       } else if (block.number > blockStart){\n           error(1);\n           return (false);\n       } else if ((postulantsIndex[_addr] > 0) || (votersIndex[_addr] == 0)) {\n           error(2);\n           return (false);\n       } else {\n           uint pos = postulants.length++;\n           Voter postulant = voters[votersIndex[_addr]];\n           postulants[pos] = Postulant(_addr, postulant.name, postulant.surename, _party, 0);\n           postulantsIndex[_addr] = pos;\n           newPostulant(_addr);\n           return (true);\n       }\n   }\n\n   function setVerifier(address _addr, address _verifier) returns (bool){\n       if (owner != msg.sender){\n           error(0);\n           return (false);\n       } else if (block.number > blockStart){\n           error(1);\n           return (false);\n       } else if ((votersIndex[_addr] == 0) || (votersIndex[_verifier] == 0)) {\n           error(2);\n           return (false);\n       } else {\n           voters[ votersIndex[_addr] ].verifier = _verifier;\n           verifierSet(_addr, _verifier);\n           return (true);\n       }\n   }\n\n   function vote(address _toVote) returns (bool){\n       if ((block.number < blockStart) || (block.number > blockEnd)){\n           error(1);\n           return (false);\n       } else {\n           uint voterIndex = votersIndex[msg.sender];\n           if (( voterIndex  == 0) || ( postulantsIndex[_toVote] == 0)) {\n               error(2);\n               return (false);\n           } else if (voters[voterIndex].alreadyVote){\n               error(4);\n               return (false);\n           } else if (voters[voterIndex].verifier == address(0x0)){\n               error(7);\n               return (false);\n           }  else {\n               voters[voterIndex].alreadyVote = true;\n               votes[msg.sender] = _toVote;\n               votesDone ++;\n               votesToVerify ++;\n               voteAdded(msg.sender);\n               return (true);\n           }\n       }\n   }\n\n   function verify(address _toVerify) returns (bool){\n       if (block.number < blockStart){\n           error(1);\n           return (false);\n       } else {\n           uint _toVerifyIndex = votersIndex[_toVerify];\n           if (_toVerifyIndex == 0){\n               error(2);\n               return (false);\n           } else if (!voters[_toVerifyIndex].alreadyVote){\n               error(6);\n               return (false);\n           } else if (voters[_toVerifyIndex].verifier != msg.sender){\n               error(0);\n               return (false);\n           } else {\n               postulants[ postulantsIndex[ votes[_toVerify] ] ].votesAmount ++;\n               voters[ _toVerifyIndex ].verified = true;\n               votesToVerify --;\n               voteVerified(_toVerify, msg.sender);\n               return (true);\n           }\n       }\n   }\n\n   function seeVote() constant returns (address, bool){\n       uint voterIndex = votersIndex[msg.sender];\n       if ((voterIndex > 0) && (voters[voterIndex].alreadyVote)){\n           return (votes[msg.sender], voters[voterIndex].verified);\n       } else {\n           return (0x0, false);\n       }\n   }\n\n   function getVotersCount() public constant returns(uint) {\n       return voters.length;\n   }\n\n   function getPostulantsCount() public constant returns(uint) {\n       return postulants.length;\n   }\n\n}\n\n",
                "language": "Solidity",
                "languageVersion": "0.4.4",
                "compilerVersion": "0.4.4",
                "compilerOptions": "--combined-json bin,abi,userdoc,devdoc --add-std --optimize",
                "abiDefinition": [
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_addr",
                                "type": "address"
                            },
                            {
                                "name": "_verifier",
                                "type": "address"
                            }
                        ],
                        "name": "setVerifier",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "ended",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [
                            {
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "name": "votersIndex",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_toVerify",
                                "type": "address"
                            }
                        ],
                        "name": "verify",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_toVote",
                                "type": "address"
                            }
                        ],
                        "name": "vote",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "seeVote",
                        "outputs": [
                            {
                                "name": "",
                                "type": "address"
                            },
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "name": "postulants",
                        "outputs": [
                            {
                                "name": "addr",
                                "type": "address"
                            },
                            {
                                "name": "name",
                                "type": "string"
                            },
                            {
                                "name": "surename",
                                "type": "string"
                            },
                            {
                                "name": "party",
                                "type": "string"
                            },
                            {
                                "name": "votesAmount",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [
                            {
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "name": "postulantsIndex",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "blockStart",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "electionName",
                        "outputs": [
                            {
                                "name": "",
                                "type": "string"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "getPostulantsCount",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "owner",
                        "outputs": [
                            {
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_addr",
                                "type": "address"
                            },
                            {
                                "name": "_name",
                                "type": "string"
                            },
                            {
                                "name": "_surename",
                                "type": "string"
                            },
                            {
                                "name": "_born_date",
                                "type": "string"
                            },
                            {
                                "name": "_personal_id",
                                "type": "string"
                            },
                            {
                                "name": "_phisical_address",
                                "type": "string"
                            }
                        ],
                        "name": "addVoter",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "votesDone",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_addr",
                                "type": "address"
                            },
                            {
                                "name": "_party",
                                "type": "string"
                            }
                        ],
                        "name": "addPostulant",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "blockEnd",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "votesToVerify",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "getVotersCount",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "name": "voters",
                        "outputs": [
                            {
                                "name": "addr",
                                "type": "address"
                            },
                            {
                                "name": "name",
                                "type": "string"
                            },
                            {
                                "name": "surename",
                                "type": "string"
                            },
                            {
                                "name": "born_date",
                                "type": "string"
                            },
                            {
                                "name": "personal_id",
                                "type": "string"
                            },
                            {
                                "name": "phisical_address",
                                "type": "string"
                            },
                            {
                                "name": "verifier",
                                "type": "address"
                            },
                            {
                                "name": "verified",
                                "type": "bool"
                            },
                            {
                                "name": "alreadyVote",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "type": "function"
                    },
                    {
                        "inputs": [
                            {
                                "name": "_electionName",
                                "type": "string"
                            },
                            {
                                "name": "_blockStart",
                                "type": "uint256"
                            },
                            {
                                "name": "_blockEnd",
                                "type": "uint256"
                            }
                        ],
                        "type": "constructor"
                    },
                    {
                        "anonymous": false,
                        "inputs": [
                            {
                                "indexed": false,
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "name": "newVoter",
                        "type": "event"
                    },
                    {
                        "anonymous": false,
                        "inputs": [
                            {
                                "indexed": false,
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "name": "newPostulant",
                        "type": "event"
                    },
                    {
                        "anonymous": false,
                        "inputs": [
                            {
                                "indexed": false,
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "name": "voteAdded",
                        "type": "event"
                    },
                    {
                        "anonymous": false,
                        "inputs": [
                            {
                                "indexed": false,
                                "name": "",
                                "type": "address"
                            },
                            {
                                "indexed": false,
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "name": "voteVerified",
                        "type": "event"
                    },
                    {
                        "anonymous": false,
                        "inputs": [
                            {
                                "indexed": false,
                                "name": "",
                                "type": "address"
                            },
                            {
                                "indexed": false,
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "name": "verifierSet",
                        "type": "event"
                    },
                    {
                        "anonymous": false,
                        "inputs": [
                            {
                                "indexed": false,
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "name": "error",
                        "type": "event"
                    }
                ],
                "userDoc": {
                    "methods": {}
                },
                "developerDoc": {
                    "methods": {}
                }
            }
        }
    }

}
